---
title: "Debate Night Regression"
output: html_notebook
---

<<<<<<< HEAD
This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

=======
>>>>>>> 01a4206d05c3755e84f8c55b8896875b78b67eaf

### Preprocess data with PCA and scaling

Apply PCA
```{r}
# separate features and target
target <- dataset$botscore
features <- dataset
features$botscore <- NULL

pca <- preProcess(features, method = c("center", "scale", "pca"),
                  thresh = 0.95, pcaComp = NULL)
print(pca)
transformed <- predict(pca, dataset)
summary(transformed)
```

normalize PCA transformed features
```{r}
transformed <- data.frame(transformed)

# separate features and target
target <- transformed$botscore
features <- transformed
features$botscore <- NULL

normalized <- normalize(features, method = "range", range = c(0, 1), 
                             on.constant = "quiet")

# put together processed feature columns and target
preprocessed <- cbind(normalized, target)

# rename target variable
colnames(preprocessed)[8] <- "botscore"

summary(preprocessed)
```


#### Split Train and Test data
```{r}
split_point <- 0.75*nrow(preprocessed)
data_train <- preprocessed[1:split_point,]
data_test <- preprocessed[(split_point+1):nrow(preprocessed),]
```


### Construct Regressor

construct trainControl object
```{r}
regtrain_control <- trainControl(
  method = "repeatedcv",
  number = 10,
  repeats = 10,
  returnResamp = "all"
)
```

```{r}
linRegressor <- train(botscore ~ friendsCount + retweetsCount + listedCount, data = data_train, method = "lm", trControl = regtrain_control)
linRegressor
```


### Implement Artificial Neural Network

Load library
```{r}
library(neuralnet)
```

Train Neural net
```{r}
layer_neurons = c(3,2)

n <- names(data_train)

nn = neuralnet(botscore ~ ., data = data_train, hidden = layer_neurons, 
               stepmax = 10000, threshold = 0.00005,act.fct = "logistic", 
               linear.output = T, algorithm = "sag")
```






